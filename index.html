<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
</head>
<body>

<canvas id="world"></canvas>

<script src="./tmlib.min.js"></script>
<script src="./precure.min.js"></script>
<script src="./src/tm/ui/listview.js"></script>
<script>
tm.game.setup({
    startLabel: "game"
});

tm.define("GameScene", {
    superClass: "Scene",
    init: function() {
        this.superInit();
        
        var title = Label("選択してね", 30)
            .setFillStyle("black")
            .setPosition(SCREEN_CENTER_X, 30)
            .addChildTo(this);
        
        var listView = ListView({
            width: SCREEN_WIDTH - 200,
            height: SCREEN_HEIGHT - 100,

            model: precure.allStars,
            // model: precure.suite.girls,
            
            createView: function(item, index) {
                var view = tm.ui.ListView.DEFAULT_PARAM.createView(item, index);
                view.label.text = item.humanName;
                view.interactive = true;
                view.boundingType = "rect";

                view.selected = RectangleShape({
                    width: view.width,
                    height: view.height,
                    fillStyle: "rgba(255, 0, 0, 0.1)",
                }).addChildTo(view).hide();

                var nomove = false;
                view.onpointingstart = function(e) {
                    nomove = true;
                };
                view.onpointingmove = function(e) {
                    if (e.app.pointing.deltaPosition.y !== 0) {
                        nomove = false;
                    }
                }
                view.onpointingend = function(e) {
                    if (nomove) {
                        title.text = item.precureName;
                        listView.innerPanel.children.forEach(function(_){ _.selected.hide() })
                        this.selected.show();
                    }
                };
                return view;
            },
        })
            .setPosition(SCREEN_CENTER_X, SCREEN_CENTER_Y + 25)
            .addChildTo(this);
    }
});
</script>

</body>
</html>